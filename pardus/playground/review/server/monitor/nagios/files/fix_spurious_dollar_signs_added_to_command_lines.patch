--- common/macros.c.orig	2011-07-27 21:32:37.000000000 +0200
+++ common/macros.c	2011-07-27 21:33:13.000000000 +0200
@@ -185,7 +185,8 @@
 				*output_buffer = (char *)realloc(*output_buffer, strlen(*output_buffer) + strlen(temp_buffer) + 3);
 				strcat(*output_buffer, "$");
 				strcat(*output_buffer, temp_buffer);
-				strcat(*output_buffer, "$");
+				if (buf_ptr != NULL)
+					strcat(*output_buffer, "$");
 				}
 
 			/* insert macro */
