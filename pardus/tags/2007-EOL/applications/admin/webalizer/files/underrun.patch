--- webalizer-2.01-10/webalizer.c.underrun	2004-06-18 07:53:48.000000000 -0400
+++ webalizer-2.01-10/webalizer.c	2004-06-18 07:59:30.000000000 -0400
@@ -585,10 +585,16 @@
          rec_sec =atoi(&log_rec.datetime[19]);   /* get second number       */
 
          /* Kludge for Netscape server time (0-24?) error                   */
-         if (rec_hour>23) rec_hour=0;
+         if (rec_hour > 23)
+         	rec_hour=0;
+         /* Handle leap seconds (AC 2004) */
+         if (rec_sec > 59 && rec_sec < 62)	/* 23:59:60/61 exist */
+         	rec_sec = 59;
 
          /* minimal sanity check on date */
-         if ((i>=12)||(rec_min>59)||(rec_sec>59)||(rec_year<1990))
+         if ( i >= 12 || rec_min < 0 || rec_min > 59 ||
+              rec_sec < 0 || rec_sec > 59 || rec_year<1990 ||
+         	rec_day < 0)
          {
             total_bad++;                /* if a bad date, bump counter      */
             if (verbose)
