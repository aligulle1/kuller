--- ext/speex/gstspeexdec.c.orig	2008-04-17 20:14:30.000000000 +0300
+++ ext/speex/gstspeexdec.c	2008-04-17 20:15:05.000000000 +0300
@@ -507,7 +507,7 @@
   if (!dec->header)
     goto no_header;
 
-  if (dec->header->mode >= SPEEX_NB_MODES)
+  if (dec->header->mode >= SPEEX_NB_MODES || dec->header->mode < 0)
     goto mode_too_old;
 
   dec->mode = (SpeexMode *) speex_mode_list[dec->header->mode];
