Commit 8811930dc74a503415b35c4a79d14fb0b408a361 ("splice: missing user
pointer access verification") added the proper access_ok() calls to
copy_from_user_mmap_sem() which ensures we can copy the struct iovecs
from userspace to the kernel.

But we also must check whether we can access the actual memory region
pointed to by the struct iovec to fix the access checks properly.

diff --git a/fs/splice.c b/fs/splice.c
index 684bca3..4a40801 100644
--- a/fs/splice.c
+++ b/fs/splice.c
@@ -1138,7 +1138,7 @@ static int get_iovec_page_array(const struct iovec __user *iov,
 		if (unlikely(!len))
 			break;
 		error = -EFAULT;
-		if (unlikely(!base))
+		if (unlikely(!access_ok(VERIFY_READ, base, len)))
 			break;
 
 		/*
