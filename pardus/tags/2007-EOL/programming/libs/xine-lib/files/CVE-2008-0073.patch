--- src/input/libreal/sdpplin.c.orig	2008-03-19 17:20:50.000000000 +0200
+++ src/input/libreal/sdpplin.c	2008-03-19 17:26:23.000000000 +0200
@@ -143,7 +143,11 @@
     handled=0;
     
     if(filter(*data,"a=control:streamid=",&buf)) {
-      desc->stream_id=atoi(buf);
+      unsigned long tmp = strtoul(buf, NULL, 10);
+      if ( tmp > UINT16_MAX )
+         lprintf("stream id out of bound: %lu\n", tmp);
+      else
+         desc->stream_id=tmp;
       handled=1;
       *data=nl(*data);
     }
@@ -252,7 +256,10 @@
       }
       stream=sdpplin_parse_stream(&data);
       lprintf("got data for stream id %u\n", stream->stream_id);
-      desc->stream[stream->stream_id]=stream;
+      if ( stream->stream_id >= desc->stream_count )
+         lprintf("stream id %u is greater than stream count %u\n", stream->stream_id, desc->stream_count);
+      else
+         desc->stream[stream->stream_id]=stream;
       continue;
     }
 
@@ -293,7 +300,11 @@
     }
     
     if(filter(data,"a=StreamCount:integer;",&buf)) {
-      desc->stream_count=atoi(buf);
+       unsigned long tmp = strtoul(buf, NULL, 10);
+       if ( tmp > UINT16_MAX )
+          lprintf("stream count out of bound: %lu\n", tmp);
+       else
+          desc->stream_count = tmp;
       desc->stream = malloc(sizeof(sdpplin_stream_t*)*desc->stream_count);
       handled=1;
       data=nl(data);

--- src/input/libreal/sdpplin.h.orig	2008-03-19 17:20:54.000000000 +0200
+++ src/input/libreal/sdpplin.h	2008-03-19 17:21:37.000000000 +0200
@@ -37,7 +37,7 @@
   char *id;
   char *bandwidth;
 
-  int stream_id;
+  uint16_t stream_id;
   char *range;
   char *length;
   char *rtpmap;
@@ -81,7 +81,7 @@
 
   int flags;
   int is_real_data_type;
-  int stream_count;
+  uint16_t stream_count;
   char *title;
   char *author;
   char *copyright;
