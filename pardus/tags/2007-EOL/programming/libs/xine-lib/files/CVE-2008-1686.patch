--- src/libxineadec/xine_speex_decoder.c.orig	2008-04-15 19:11:50.000000000 +0300
+++ src/libxineadec/xine_speex_decoder.c	2008-04-15 19:13:17.000000000 +0300
@@ -204,7 +204,7 @@
       if (!this->st) {
 	SpeexMode * spx_mode;
 	SpeexHeader * spx_header;
-	int modeID;
+	unsigned int modeID;
 	int bitrate;
 
 	speex_bits_init (&this->bits);
@@ -216,7 +216,11 @@
 	  return;
 	}
 
-	modeID = spx_header->mode;
+	modeID = (unsigned int)spx_header->mode;
+    if (modeID >= SPEEX_NB_MODES) {
+        xprintf(this->stream->xine, XINE_VERBOSITY_DEBUG, LOG_MODULE ": invalid mode ID %u\n", modeID);
+        return;
+    }
 	spx_mode = (SpeexMode *) speex_mode_list[modeID];
 
 	if (spx_mode->bitstream_version != spx_header->mode_bitstream_version) {
