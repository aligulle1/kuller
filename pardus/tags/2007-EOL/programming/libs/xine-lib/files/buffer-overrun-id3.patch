diff -Nur xine-lib-1.1.10.1/src/demuxers/id3.c xine-lib-1.1.10.1-new/src/demuxers/id3.c
--- xine-lib-1.1.10.1/src/demuxers/id3.c	2008-01-27 03:54:05.000000000 +0200
+++ xine-lib-1.1.10.1-new/src/demuxers/id3.c	2008-08-17 13:47:50.000000000 +0300
@@ -275,15 +275,16 @@
                                id3v22_frame_header_t *frame_header) {
   char *buf;
   int enc;
-  
-  buf = malloc(frame_header->size + 1);
+  const size_t bufsize = frame_header->size +1;
+  if ( bufsize <= 2 ) /* frames has to be _at least_ 1 byte */
+      return 0;
+  buf = malloc(bufsize);
   if (buf == NULL) {
     lprintf("malloc error");
     return 0;
   }
 
   if (input->read (input, buf, frame_header->size) == frame_header->size) {
-    buf[frame_header->size] = 0;
     enc = buf[0];
     if( enc >= ID3_ENCODING_COUNT )
       enc = 0;
@@ -470,7 +471,11 @@
   char *buf;
   int enc;
 
-  buf = malloc(frame_header->size + 1);
+  const size_t bufsize = frame_header->size +1;
+  if ( bufsize <= 2 ) /* frames has to be _at least_ 1 byte */
+      return 0;
+
+  buf = malloc(bufsize);
   if (buf == NULL) {
     lprintf("malloc error");
     return 0;
@@ -719,7 +724,10 @@
   char *buf;
   int enc;
 
-  buf = malloc(frame_header->size + 1);
+  const size_t bufsize = frame_header->size +1;
+  if ( bufsize <= 2 ) /* frames has to be _at least_ 1 byte */
+      return 0;
+  buf = malloc(bufsize);
   if (buf == NULL) {
     lprintf("malloc error");
     return 0;
