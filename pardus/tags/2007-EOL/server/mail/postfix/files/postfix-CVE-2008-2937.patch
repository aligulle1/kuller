--- src/local/mailbox.c	2006-06-26 14:59:19.000000000 +0200
+++ src/local/mailbox.c	2008-07-31 16:57:56.000000000 +0200
@@ -194,7 +194,11 @@
 	    vstream_fclose(mp->fp);
 	    dsb_simple(why, "5.2.0",
 		       "destination %s is not a regular file", mailbox);
-	} else {
+        } else if ( st.st_uid != usr_attr.uid) {
+            vstream_fclose(mp->fp);
+            dsb_simple(why, "4.2.0",
+                       "destination %s is not owned by recipient", mailbox);
+ 	} else {
 	    end = vstream_fseek(mp->fp, (off_t) 0, SEEK_END);
 	    mail_copy_status = mail_copy(COPY_ATTR(state.msg_attr), mp->fp,
 					 copy_flags, "\n", why);
--- src/virtual/mailbox.c	2006-06-26 14:59:19.000000000 +0200
+++ src/virtual/mailbox.c	2008-07-31 16:57:39.000000000 +0200
@@ -125,6 +125,10 @@
 	    msg_warn("recipient %s: destination %s is not a regular file",
 		     state.msg_attr.rcpt.address, usr_attr.mailbox);
 	    dsb_simple(why, "5.3.5", "mail system configuration error");
+        } else if ( st.st_uid != usr_attr.uid) {
+            vstream_fclose(mp->fp);
+            dsb_simple(why, "4.2.0",
+              "destination %s is not owned by recipient", usr_attr.mailbox);
 	} else {
 	    end = vstream_fseek(mp->fp, (off_t) 0, SEEK_END);
 	    mail_copy_status = mail_copy(COPY_ATTR(state.msg_attr), mp->fp,
