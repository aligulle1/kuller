Index: src/dom/lsimpl.h
===================================================================
--- src/dom/lsimpl.h	(revision 14553)
+++ src/dom/lsimpl.h	(revision 14554)
@@ -29,6 +29,8 @@
  *  Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
  */
 
+#include <glib.h>
+
 #include "domimpl.h"
 #include "events.h"
 #include "traversal.h"
@@ -236,7 +238,7 @@
 
     void spaces();
 
-    void po(char *fmt, ...);
+    void po(char *fmt, ...) G_GNUC_PRINTF(2,3);
 
     void pos(const DOMString &str);
 
Index: src/dom/svg/svgparser.h
===================================================================
--- src/dom/svg/svgparser.h	(revision 14553)
+++ src/dom/svg/svgparser.h	(revision 14554)
@@ -30,6 +30,7 @@
  *  Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
  */
 
+#include <glib.h>
 
 #include "svgimpl.h"
 
@@ -122,7 +123,7 @@
     /**
      *
      */
-    void error(char *format, ...);
+    void error(char *format, ...) G_GNUC_PRINTF(2,3);
 
 
 
Index: src/dom/xmlreader.cpp
===================================================================
--- src/dom/xmlreader.cpp	(revision 14553)
+++ src/dom/xmlreader.cpp	(revision 14554)
@@ -788,7 +788,7 @@
                         closeTagQualifiedName);
     if (openTagQualifiedName != closeTagQualifiedName)
         {
-        error("Mismatched closing tag.  Expected </%S>. Got '%S'.",
+        error("Mismatched closing tag.  Expected </%s>. Got '%s'.",
               openTagQualifiedName.c_str(), closeTagQualifiedName.c_str());
         return p0;
         }
Index: src/dom/uri.h
===================================================================
--- src/dom/uri.h	(revision 14553)
+++ src/dom/uri.h	(revision 14554)
@@ -30,6 +30,7 @@
  *  Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
  */
 
+#include <glib.h>
 
 #include "dom.h"
 
@@ -197,9 +198,9 @@
 
     DOMString fragment;
 
-    void error(const char *fmt, ...);
+    void error(const char *fmt, ...) G_GNUC_PRINTF(2,3);
 
-    void trace(const char *fmt, ...);
+    void trace(const char *fmt, ...) G_GNUC_PRINTF(2,3);
 
 
     int peek(int p);
Index: src/dom/xpathparser.h
===================================================================
--- src/dom/xpathparser.h	(revision 14553)
+++ src/dom/xpathparser.h	(revision 14554)
@@ -33,6 +33,7 @@
 
 #include <stdio.h>
 #include <stdarg.h>
+#include <glib.h>
 
 #include <string>
 #include <vector>
@@ -415,7 +416,7 @@
     /**
      *
      */
-    void trace(const char *fmt, ...);
+    void trace(const char *fmt, ...) G_GNUC_PRINTF(2,3);
 
     /**
      *
@@ -425,7 +426,7 @@
     /**
      *
      */
-    void error(const char *fmt, ...);
+    void error(const char *fmt, ...) G_GNUC_PRINTF(2,3);
 
     //#################################
     //# LEXICAL  SCANNING
Index: src/dom/cssparser.h
===================================================================
--- src/dom/cssparser.h	(revision 14553)
+++ src/dom/cssparser.h	(revision 14554)
@@ -29,6 +29,7 @@
  *  Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
  */
 
+#include <glib.h>
 
 #include "dom.h"
 
@@ -81,7 +82,7 @@
     /**
      *
      */
-    void error(char *fmt, ...);
+    void error(char *fmt, ...) G_GNUC_PRINTF(2,3);
 
     /**
      * Get the character at the given location in the buffer.
Index: src/dom/xmlreader.h
===================================================================
--- src/dom/xmlreader.h	(revision 14553)
+++ src/dom/xmlreader.h	(revision 14554)
@@ -30,6 +30,7 @@
  *  Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
  */
 
+#include <glib.h>
 
 #include "dom.h"
 
@@ -80,7 +81,7 @@
 
 protected:
 
-    void error(char *format, ...);
+    void error(char *format, ...) G_GNUC_PRINTF(2,3);
 
     int  get(int ch);
     int  peek(int ch);
Index: src/dom/util/ziptool.h
===================================================================
--- src/dom/util/ziptool.h	(revision 14553)
+++ src/dom/util/ziptool.h	(revision 14554)
@@ -32,6 +32,7 @@
  *  Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
  */
 
+#include <glib.h>
 
 #include <vector>
 #include <string>
@@ -203,8 +204,8 @@
     std::string fileName;
 
     //debug messages
-    void error(char *fmt, ...);
-    void trace(char *fmt, ...);
+    void error(char *fmt, ...) G_GNUC_PRINTF(2,3);
+    void trace(char *fmt, ...) G_GNUC_PRINTF(2,3);
 
     unsigned long crc;
 
@@ -469,8 +470,8 @@
 private:
 
     //debug messages
-    void error(char *fmt, ...);
-    void trace(char *fmt, ...);
+    void error(char *fmt, ...) G_GNUC_PRINTF(2,3);
+    void trace(char *fmt, ...) G_GNUC_PRINTF(2,3);
 
     //# Private writing methods
 
Index: src/libcroco/cr-statement.c
===================================================================
--- src/libcroco/cr-statement.c	(revision 14553)
+++ src/libcroco/cr-statement.c	(revision 14554)
@@ -2432,7 +2432,7 @@
         g_return_if_fail (a_fp && a_this);
         gchar *str = cr_statement_ruleset_to_string (a_this, a_indent);
         if (str) {
-                fprintf (a_fp, str);
+                fprintf (a_fp, "%s", str);
                 g_free (str);
                 str = NULL;
         }
@@ -2475,7 +2475,7 @@
         gchar *str = cr_statement_charset_to_string (a_this,
                                               a_indent) ;
         if (str) {
-                fprintf (a_fp, str) ;
+                fprintf (a_fp, "%s", str) ;
                 g_free (str) ;
                 str = NULL ;
         }
@@ -2497,7 +2497,7 @@
 
         gchar *str = cr_statement_at_page_rule_to_string (a_this, a_indent) ;
         if (str) {
-                fprintf (a_fp, str);
+                fprintf (a_fp, "%s", str);
                 g_free (str) ;
                 str = NULL ; 
         }
@@ -2520,7 +2520,7 @@
 
         str = cr_statement_media_rule_to_string (a_this, a_indent) ;
         if (str) {
-                fprintf (a_fp, str) ;
+                fprintf (a_fp, "%s", str) ;
                 g_free (str) ;
                 str = NULL ;
         }
@@ -2543,7 +2543,7 @@
 
         str = cr_statement_import_rule_to_string (a_this, a_indent) ;
         if (str) {
-                fprintf (a_fp, str) ;
+                fprintf (a_fp, "%s", str) ;
                 g_free (str) ;
                 str = NULL ;
         }
Index: src/widgets/desktop-widget.cpp
===================================================================
--- src/widgets/desktop-widget.cpp	(revision 14553)
+++ src/widgets/desktop-widget.cpp	(revision 14554)
@@ -823,7 +823,7 @@
                 GTK_DIALOG_DESTROY_WITH_PARENT,
                 GTK_MESSAGE_WARNING,
                 GTK_BUTTONS_YES_NO,
-                text);
+                "%s", text);
         gint response = gtk_dialog_run(GTK_DIALOG(dialog));
         gtk_widget_destroy(dialog);
         if (response == GTK_RESPONSE_YES)
Index: src/extension/internal/svg.cpp
===================================================================
--- src/extension/internal/svg.cpp	(revision 14553)
+++ src/extension/internal/svg.cpp	(revision 14554)
@@ -120,7 +120,7 @@
     GnomeVFSResult result = gnome_vfs_open (&handle, uri_local, GNOME_VFS_OPEN_READ);
 
     if (result != GNOME_VFS_OK) {
-        g_warning(gnome_vfs_result_to_string(result));
+        g_warning("%s", gnome_vfs_result_to_string(result));
     }
 
     std::vector<gchar> doc;
Index: src/interface.cpp
===================================================================
--- src/interface.cpp	(revision 14553)
+++ src/interface.cpp	(revision 14554)
@@ -1247,7 +1247,7 @@
     gchar *safeMsg = Inkscape::IO::sanitizeString(message);
 
     dlg = gtk_message_dialog_new(NULL, GTK_DIALOG_DESTROY_WITH_PARENT, GTK_MESSAGE_ERROR,
-                                 GTK_BUTTONS_CLOSE, safeMsg);
+                                 GTK_BUTTONS_CLOSE, "%s", safeMsg);
     sp_transientize(dlg);
     gtk_window_set_resizable(GTK_WINDOW(dlg), FALSE);
     gtk_dialog_run(GTK_DIALOG(dlg));
Index: src/xml/repr-css.cpp
===================================================================
--- src/xml/repr-css.cpp	(revision 14553)
+++ src/xml/repr-css.cpp	(revision 14554)
@@ -186,10 +186,9 @@
     for ( List<AttributeRecord const> iter = css->attributeList() ;
           iter ; ++iter )
     {
-        g_print(g_quark_to_string(iter->key));
-        g_print(":\t");
-        g_print(iter->value);
-        g_print("\n");
+        gchar const * key = g_quark_to_string(iter->key);
+        gchar const * val = iter->value;
+        g_print("%s:\t%s\n",key,val);
     }
 }
 
Index: src/debug/logger.cpp
===================================================================
--- src/debug/logger.cpp	(revision 14553)
+++ src/debug/logger.cpp	(revision 14554)
@@ -116,7 +116,7 @@
                 }
             }
             if (!iter->name) {
-                g_warning("Unknown debugging category %*s", end - start, start);
+                g_warning("Unknown debugging category %*s", (int)(end - start), start);
             }
         }
         if (*end) {
Index: src/file.cpp
===================================================================
--- src/file.cpp	(revision 14553)
+++ src/file.cpp	(revision 14554)
@@ -283,7 +283,7 @@
     }
 
     tmp += "]";
-    g_message(tmp.c_str());
+    g_message("%s", tmp.c_str());
 }
 
 void dump_ustr(Glib::ustring const &ustr)
@@ -344,7 +344,7 @@
                 tmp += "            ";
             }
 
-            g_message( tmp.c_str() );
+            g_message( "%s", tmp.c_str() );
         }
     } catch (...) {
         g_message("XXXXXXXXXXXXXXXXXX Exception" );
Index: src/pedro/pedrodom.cpp
===================================================================
--- src/pedro/pedrodom.cpp	(revision 14553)
+++ src/pedro/pedrodom.cpp	(revision 14554)
@@ -652,7 +652,7 @@
     p = getWord(p, closeTagName);
     if (openTagName != closeTagName)
         {
-        error("Mismatched closing tag.  Expected </%S>. Got '%S'.",
+        error("Mismatched closing tag.  Expected </%s>. Got '%s'.",
                 openTagName.c_str(), closeTagName.c_str());
         return p0;
         }
Index: src/jabber_whiteboard/pedrogui.cpp
===================================================================
--- src/jabber_whiteboard/pedrogui.cpp	(revision 14553)
+++ src/jabber_whiteboard/pedrogui.cpp	(revision 14554)
@@ -1992,24 +1992,26 @@
 {
     va_list args;
     va_start(args, fmt);
-    vsnprintf(writeBuf, writeBufLen, fmt, args);
+    gchar * buffer = g_strdup_vprintf(fmt, args);
     va_end(args) ;
 
-    Gtk::MessageDialog dlg(writeBuf,
+    Gtk::MessageDialog dlg(buffer,
                            false,
                            Gtk::MESSAGE_ERROR,
                            Gtk::BUTTONS_OK,
                            true);
     dlg.run();
+    g_free(buffer);
 }
 
 void PedroGui::status(const char *fmt, ...)
 {
     va_list args;
     va_start(args, fmt);
-    vsnprintf(writeBuf, writeBufLen, fmt, args);
+    gchar * buffer = g_strdup_vprintf(fmt, args);
     va_end(args) ;
-    messageList.postMessage("STATUS", writeBuf);
+    messageList.postMessage("STATUS", buffer);
+    g_free(buffer);
 }
 
 //################################
@@ -2227,13 +2229,13 @@
         case XmppEvent::EVENT_STATUS:
             {
             //printf("##### STATUS: %s\n", event.getData().c_str());
-            status(event.getData().c_str());
+            status("%s", event.getData().c_str());
             break;
             }
         case XmppEvent::EVENT_ERROR:
             {
             //printf("##### ERROR: %s\n", event.getData().c_str());
-            error(event.getData().c_str());
+            error("%s", event.getData().c_str());
             padlockDisable();
             break;
             }
Index: src/pedro/pedrodom.h
===================================================================
--- src/pedro/pedrodom.h	(revision 14553)
+++ src/pedro/pedrodom.h	(revision 14554)
@@ -23,6 +23,8 @@
  *  Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
  */
 
+#include <glib.h>
+
 #include <string>
 #include <vector>
 
@@ -312,7 +314,7 @@
 
     void getLineAndColumn(long pos, long *lineNr, long *colNr);
 
-    void error(char *fmt, ...);
+    void error(char *fmt, ...) G_GNUC_PRINTF(2,3);
 
     int peek(long pos);
 
Index: src/pedro/pedroxmpp.cpp
===================================================================
--- src/pedro/pedroxmpp.cpp	(revision 14553)
+++ src/pedro/pedroxmpp.cpp	(revision 14554)
@@ -295,12 +295,13 @@
 {
     va_list args;
     va_start(args,fmt);
-    vsnprintf(targetWriteBuf, targetWriteBufLen, fmt, args);
+    gchar * buffer = g_strdup_vprintf(fmt, args);
     va_end(args) ;
-    fprintf(stderr, "Error:%s\n", targetWriteBuf);
+    fprintf(stderr, "Error:%s\n", buffer);
     XmppEvent evt(XmppEvent::EVENT_ERROR);
-    evt.setData(targetWriteBuf);
+    evt.setData(buffer);
     dispatchXmppEvent(evt);
+    g_free(buffer);
 }
 
 
@@ -312,12 +313,13 @@
 {
     va_list args;
     va_start(args,fmt);
-    vsnprintf(targetWriteBuf, targetWriteBufLen, fmt, args);
+    gchar * buffer = g_strdup_vprintf(fmt, args);
     va_end(args) ;
-    //printf("Status:%s\n", targetWriteBuf);
+    //printf("Status:%s\n", buffer);
     XmppEvent evt(XmppEvent::EVENT_STATUS);
-    evt.setData(targetWriteBuf);
+    evt.setData(buffer);
     dispatchXmppEvent(evt);
+    g_free(buffer);
 }
 
 
@@ -1158,7 +1160,7 @@
              "IQ set does not contain a 'from' address because "
              "the entity is not registered with the server");
             }
-        error((char *)errMsg.c_str());
+        error("%s",(char *)errMsg.c_str());
         }
 
     else if (id.find("regcancel") != id.npos)
@@ -1197,7 +1199,7 @@
                  "IQ set does not contain a 'from' address because "
                  "the entity is not registered with the server");
             }
-        error((char *)errMsg.c_str());
+        error("%s",(char *)errMsg.c_str());
         }
 
     return true;
@@ -1287,17 +1289,19 @@
 
 bool XmppClient::write(char *fmt, ...)
 {
+    bool rc = true;
     va_list args;
     va_start(args,fmt);
-    vsnprintf((char *)writeBuf, writeBufLen, fmt,args);
+    gchar * buffer = g_strdup_vprintf(fmt,args);
     va_end(args) ;
-    status("SEND: %s", writeBuf);
-    if (!sock->write((char *)writeBuf))
+    status("SEND: %s", buffer);
+    if (!sock->write(buffer))
         {
         error("Cannot write to socket");
-        return false;
+        rc = false;
         }
-    return true;
+    g_free(buffer);
+    return rc;
 }
 
 
@@ -1388,7 +1392,7 @@
             {
             errMsg.append("some registration information was not provided");
             }
-        error((char *)errMsg.c_str());
+        error("%s",(char *)errMsg.c_str());
         delete elem;
         return false;
         }
@@ -1612,7 +1616,7 @@
     char *fmt =
     "<auth xmlns='urn:ietf:params:xml:ns:xmpp-sasl' "
         "mechanism='DIGEST-MD5'/>\n";
-    if (!write(fmt))
+    if (!write("%s",fmt))
         return false;
 
     DOMString recbuf = readStanza();
@@ -1760,7 +1764,7 @@
 
     fmt =
     "<response xmlns='urn:ietf:params:xml:ns:xmpp-sasl'/>\n";
-    if (!write(fmt))
+    if (!write("%s",fmt))
         return false;
 
     recbuf = readStanza();
@@ -1843,7 +1847,7 @@
         delete elem;
         char *fmt =
         "<starttls xmlns='urn:ietf:params:xml:ns:xmpp-tls'/>\n";
-        if (!write(fmt))
+        if (!write("%s",fmt))
             return false;
         recbuf = readStanza();
         status("RECV: '%s'\n", recbuf.c_str());
@@ -2087,7 +2091,7 @@
         DOMString givenJid, givenResource;
         parseJid(givenFullJid, givenJid, givenResource);
         status("given user: %s realm: %s, rsrc: %s",
-           givenJid.c_str(), givenResource.c_str());
+           givenJid.c_str(), realm.c_str(), givenResource.c_str());
         setResource(givenResource);
         }
         
@@ -2143,7 +2147,7 @@
 
     fmt =
      "<presence/>\n";
-    if (!write(fmt))
+    if (!write("%s",fmt))
         return false;
 
     /*
@@ -2217,7 +2221,7 @@
         {
         char *fmt =
         "<presence type='unavailable'/>\n";
-        write(fmt);
+        write("%s",fmt);
         }
     keepGoing = false;
     connected = false;
Index: src/jabber_whiteboard/pedrogui.h
===================================================================
--- src/jabber_whiteboard/pedrogui.h	(revision 14553)
+++ src/jabber_whiteboard/pedrogui.h	(revision 14554)
@@ -790,9 +790,9 @@
     XmppConfig config;
 
 
-    virtual void error(const char *fmt, ...);
+    virtual void error(const char *fmt, ...) G_GNUC_PRINTF(2,3);
 
-    virtual void status(const char *fmt, ...);
+    virtual void status(const char *fmt, ...) G_GNUC_PRINTF(2,3);
 
 
 
@@ -893,10 +893,6 @@
     std::vector<ChatWindow *>chats;
 
     std::vector<GroupChatWindow *>groupChats;
-
-    static const int writeBufLen = 2048;
-
-    char writeBuf[writeBufLen];
 };
 
 
Index: src/pedro/pedroxmpp.h
===================================================================
--- src/pedro/pedroxmpp.h	(revision 14553)
+++ src/pedro/pedroxmpp.h	(revision 14554)
@@ -24,6 +24,7 @@
  */
 
 #include <stdio.h>
+#include <glib.h>
 #include <vector>
 #include <map>
 
@@ -566,13 +567,13 @@
     /**
      * Send an error message to all subscribers
      */
-    void error(char *fmt, ...);
+    void error(char *fmt, ...) G_GNUC_PRINTF(2,3);
 
 
     /**
      * Send a status message to all subscribers
      */
-    void status(char *fmt, ...);
+    void status(char *fmt, ...) G_GNUC_PRINTF(2,3);
 
     //###########################
     //# LISTENERS
@@ -629,10 +630,6 @@
 
     std::vector<XmppEvent> eventQueue;
     bool eventQueueEnabled;
-
-    static const int targetWriteBufLen = 2048;
-
-    char targetWriteBuf[targetWriteBufLen];
 };
 
 
@@ -725,7 +722,7 @@
     /**
      *
      */
-    virtual bool write(char *fmt, ...);
+    virtual bool write(char *fmt, ...) G_GNUC_PRINTF(2,3);
 
     //#######################
     //# V A R I A B L E S
@@ -1146,10 +1143,6 @@
 
     bool doRegister;
 
-    static const int writeBufLen = 2048;
-
-    unsigned char writeBuf[writeBufLen];
-
     std::vector<XmppGroupChat *>groupChats;
 
     //#### Roster
Index: src/trace/siox.cpp
===================================================================
--- src/trace/siox.cpp	(revision 14553)
+++ src/trace/siox.cpp	(revision 14554)
@@ -884,7 +884,7 @@
         return workImage;
         }
 
-    trace("knownBg:%d knownFg:%d", knownBg.size(), knownFg.size());
+    trace("knownBg:%zu knownFg:%zu", knownBg.size(), knownFg.size());
 
 
     std::vector<CieLab> bgSignature ;
Index: src/trace/siox.h
===================================================================
--- src/trace/siox.h	(revision 14553)
+++ src/trace/siox.h	(revision 14554)
@@ -374,7 +374,7 @@
     /**
      * Error logging
      */
-    void error(char *fmt, ...);
+    void error(char *fmt, ...) G_GNUC_PRINTF(2,3);
 
 };
 
@@ -562,12 +562,12 @@
     /**
      * Error logging
      */
-    void error(char *fmt, ...);
+    void error(char *fmt, ...) G_GNUC_PRINTF(2,3);
 
     /**
      * Trace logging
      */
-    void trace(char *fmt, ...);
+    void trace(char *fmt, ...) G_GNUC_PRINTF(2,3);
 
     /**
      *  Stage 1 of the color signature work.  'dims' will be either
Index: src/message-context.h
===================================================================
--- src/message-context.h	(revision 14553)
+++ src/message-context.h	(revision 14554)
@@ -15,7 +15,7 @@
 #define SEEN_INKSCAPE_MESSAGE_CONTEXT_H
 
 #include <stdarg.h>
-#include <glib/gtypes.h>
+#include <glib.h>
 #include "message.h"
 
 namespace Inkscape {
@@ -56,7 +56,7 @@
       * @param type the message type
       * @param format a printf-style formatting string
       */
-    void setF(MessageType type, gchar const *format, ...);
+    void setF(MessageType type, gchar const *format, ...) G_GNUC_PRINTF(3,4);
 
     /** @brief pushes a message on the stack using printf-style formatting,
       *        and a stdarg argument list
@@ -82,7 +82,7 @@
       * @param type the message type
       * @param format a printf-style formatting string
       */
-    void flashF(MessageType type, gchar const *format, ...);
+    void flashF(MessageType type, gchar const *format, ...) G_GNUC_PRINTF(3,4);
 
     /** @brief pushes a message onto the stack for a brief period of time
       *        using printf-style formatting and a stdarg argument list;
Index: src/jabber_whiteboard/inkboard-document.cpp
===================================================================
--- src/jabber_whiteboard/inkboard-document.cpp	(revision 14553)
+++ src/jabber_whiteboard/inkboard-document.cpp	(revision 14554)
@@ -156,7 +156,7 @@
             Vars::WHITEBOARD_MESSAGE, this->sessionType, this->sm->getClient().getJid(),
             destJid, Vars::INKBOARD_XMLNS, this->getSessionId(), mes).c_str());
 
-        if (!this->sm->getClient().write(finalmessage)) 
+        if (!this->sm->getClient().write("%s",finalmessage)) 
             { return false; }
         else 
             { return true; }
Index: src/message-stack.h
===================================================================
--- src/message-stack.h	(revision 14553)
+++ src/message-stack.h	(revision 14554)
@@ -15,7 +15,7 @@
 #define SEEN_INKSCAPE_MESSAGE_STACK_H
 
 #include <sigc++/sigc++.h>
-#include <glib/gtypes.h>
+#include <glib.h>
 #include <stdarg.h>
 #include "gc-managed.h"
 #include "gc-finalized.h"
@@ -85,7 +85,7 @@
       *
       * @return the id of the pushed message
       */
-    MessageId pushF(MessageType type, gchar const *format, ...);
+    MessageId pushF(MessageType type, gchar const *format, ...) G_GNUC_PRINTF(3,4);
 
     /** @brief pushes a message onto the stack using printf-like formatting,
       *        using a stdarg argument list
@@ -124,7 +124,7 @@
       *
       * @return the id of the pushed message
       */
-    MessageId flashF(MessageType type, gchar const *format, ...);
+    MessageId flashF(MessageType type, gchar const *format, ...) G_GNUC_PRINTF(3,4);
 
     /** @brief temporarily pushes a message onto the stack using
       *        printf-like formatting, using a stdarg argument list
Index: src/util/format.h
===================================================================
--- src/util/format.h	(revision 14553)
+++ src/util/format.h	(revision 14554)
@@ -13,7 +13,7 @@
 #define SEEN_INKSCAPE_UTIL_FORMAT_H
 
 #include <stdarg.h>
-#include <glib/gstrfuncs.h>
+#include <glib.h>
 #include "util/share.h"
 
 namespace Inkscape {
@@ -27,6 +27,8 @@
     return result;
 }
 
+       // needed since G_GNUC_PRINTF can only be used on a declaration
+       ptr_shared<char> format(char const *format, ...) G_GNUC_PRINTF(1,2);
 inline ptr_shared<char> format(char const *format, ...) {
     va_list args;
 
Index: src/io/inkscapestream.h
===================================================================
--- src/io/inkscapestream.h	(revision 14553)
+++ src/io/inkscapestream.h	(revision 14554)
@@ -475,7 +475,7 @@
     virtual void put(gunichar ch) = 0;
     
     /* Formatted output */
-    virtual Writer& printf(char *fmt, ...) = 0;
+    virtual Writer& printf(char *fmt, ...) G_GNUC_PRINTF(2,3) = 0;
 
     virtual Writer& writeChar(char val) = 0;
 
@@ -531,7 +531,7 @@
     
     
     /* Formatted output */
-    virtual Writer &printf(char *fmt, ...);
+    virtual Writer &printf(char *fmt, ...) G_GNUC_PRINTF(2,3);
 
     virtual Writer& writeChar(char val);
 
Index: configure.ac
===================================================================
--- configure.ac	(revision 14553)
+++ configure.ac	(revision 14554)
@@ -42,7 +42,7 @@
   CFLAGS="-Wno-pointer-sign $CFLAGS"
   AC_COMPILE_IFELSE([int dummy;
 ], , CFLAGS="$ink_svd_CFLAGS",)
-  CFLAGS="-Wall -W $CFLAGS"
+  CFLAGS="-Wall -Wformat-security -W -D_FORTIFY_SOURCE=2 $CFLAGS"
 fi
 
 dnl Honor aclocal flags
@@ -690,7 +690,7 @@
   # programmer deliberately has an unused parameter (e.g. because it's used
   # as a callback or similar function pointer use).
 
-  CXXFLAGS="-Wall -W -Wpointer-arith -Wcast-align -Wsign-compare -Woverloaded-virtual -Wswitch  $CXXFLAGS"
+  CXXFLAGS="-Wall -Wformat-security -W -Wpointer-arith -Wcast-align -Wsign-compare -Woverloaded-virtual -Wswitch -D_FORTIFY_SOURCE=2 $CXXFLAGS"
 
   dnl Test for arch-specific situations.
   case "$host_cpu" in
