*** src/lib/kadm5/logger.c	(revision 19480)
--- src/lib/kadm5/logger.c	(local)
***************
*** 45,51 ****
  #include <varargs.h>
  #endif	/* HAVE_STDARG_H */
  
! #define	KRB5_KLOG_MAX_ERRMSG_SIZE	1024
  #ifndef	MAXHOSTNAMELEN
  #define	MAXHOSTNAMELEN	256
  #endif	/* MAXHOSTNAMELEN */
--- 45,51 ----
  #include <varargs.h>
  #endif	/* HAVE_STDARG_H */
  
! #define	KRB5_KLOG_MAX_ERRMSG_SIZE	2048
  #ifndef	MAXHOSTNAMELEN
  #define	MAXHOSTNAMELEN	256
  #endif	/* MAXHOSTNAMELEN */
***************
*** 261,267 ****
  #endif	/* HAVE_SYSLOG */
  
      /* Now format the actual message */
! #if	HAVE_VSPRINTF
      vsprintf(cp, actual_format, ap);
  #else	/* HAVE_VSPRINTF */
      sprintf(cp, actual_format, ((int *) ap)[0], ((int *) ap)[1],
--- 261,269 ----
  #endif	/* HAVE_SYSLOG */
  
      /* Now format the actual message */
! #if	HAVE_VSNPRINTF
!     vsnprintf(cp, sizeof(outbuf) - (cp - outbuf), actual_format, ap);
! #elif	HAVE_VSPRINTF
      vsprintf(cp, actual_format, ap);
  #else	/* HAVE_VSPRINTF */
      sprintf(cp, actual_format, ((int *) ap)[0], ((int *) ap)[1],
***************
*** 850,856 ****
      syslogp = &outbuf[strlen(outbuf)];
  
      /* Now format the actual message */
! #ifdef	HAVE_VSPRINTF
      vsprintf(syslogp, format, arglist);
  #else	/* HAVE_VSPRINTF */
      sprintf(syslogp, format, ((int *) arglist)[0], ((int *) arglist)[1],
--- 852,860 ----
      syslogp = &outbuf[strlen(outbuf)];
  
      /* Now format the actual message */
! #ifdef	HAVE_VSNPRINTF
!     vsnprintf(syslogp, sizeof(outbuf) - (syslogp - outbuf), format, arglist);
! #elif	HAVE_VSPRINTF
      vsprintf(syslogp, format, arglist);
  #else	/* HAVE_VSPRINTF */
      sprintf(syslogp, format, ((int *) arglist)[0], ((int *) arglist)[1],
