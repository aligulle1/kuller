--- mozilla/nsprpub/lib/libc/src/strcstr.c	25 Apr 2004 15:00:36 -0000	3.6
+++ mozilla/nsprpub/lib/libc/src/strcstr.c	14 Feb 2007 05:57:21 -0000
@@ -56,20 +56,21 @@ PL_strcasestr(const char *big, const cha
 }
 
 PR_IMPLEMENT(char *)
 PL_strcaserstr(const char *big, const char *little)
 {
     const char *p;
-    PRUint32 ll;
+    PRUint32 bl, ll;
 
     if( ((const char *)0 == big) || ((const char *)0 == little) ) return (char *)0;
     if( ((char)0 == *big) || ((char)0 == *little) ) return (char *)0;
 
+    bl = PL_strlen(big);
     ll = PL_strlen(little);
-    p = &big[ PL_strlen(big) - ll ];
-    if( p < big ) return (char *)0;
+    if( bl < ll ) return (char *)0;
+    p = &big[ bl - ll ];
 
     for( ; p >= big; p-- )
         /* obvious improvement available here */
             if( 0 == PL_strncasecmp(p, little, ll) )
                 return (char *)p;
 
