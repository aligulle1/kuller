--- src/libjasper/jpc/jpc_cs.c	2007-05-19 11:18:17.000000000 +0300
+++ src/libjasper/jpc/jpc_cs.c	2007-05-19 11:19:58.000000000 +0300
@@ -983,7 +983,11 @@
 		compparms->numstepsizes = (len - n) / 2;
 		break;
 	}
-if (compparms->numstepsizes > 0) {
+if (compparms->numstepsizes > 3 * JPC_MAXRLVLS + 1) {
+    jpc_qcx_destroycompparms(compparms);
+    return -1;
+}
+else if(compparms->numstepsizes > 0) {
 	compparms->stepsizes = jas_malloc(compparms->numstepsizes *
 	  sizeof(uint_fast32_t));
 	assert(compparms->stepsizes);
