--- gutenprint-5.0.1~/src/main/print-canon.c	2007-06-04 01:20:13.000000000 +0100
+++ gutenprint-5.0.1/src/main/print-canon.c	2007-09-20 22:40:35.000000000 +0100
@@ -2098,7 +2098,7 @@
 
   /* Don't send blank lines... */
 
-  if (line[0] == 0 && memcmp(line, line + 1, length - 1) == 0)
+  if (line[0] == 0 && memcmp(line, line + 1, (length * bits)  - 1) == 0)
     return 0;
 
   offset2 = offset / 8;
diff -urNad gutenprint-5.0.1~/src/main/printers.xml gutenprint-5.0.1/src/main/printers.xml
--- gutenprint-5.0.1~/src/main/printers.xml	2007-06-17 15:11:51.000000000 +0100
+++ gutenprint-5.0.1/src/main/printers.xml	2007-09-20 22:40:35.000000000 +0100
@@ -39,7 +39,7 @@
         <parameter type="float" name="Gamma">0.75</parameter>
       </parameters>
       <parameters name="PIXMA_iP4000_params">
-        <parameter type="float" name="Gamma">0.4</parameter>
+        <parameter type="float" name="Gamma">0.60</parameter>
       </parameters>
       <parameters name="PIXMA_iP4300_params">
         <parameter type="float" name="Brightness">0.7</parameter>
