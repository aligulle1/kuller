--- a/src/login-common/sasl-server.c	Tue Mar 27 01:27:32 2007 +0300
+++ b/src/login-common/sasl-server.c	Mon Nov 05 20:23:32 2007 +0200
@@ -130,14 +130,14 @@ void sasl_server_auth_begin(struct clien
 
 	mech = auth_client_find_mech(auth_client, mech_name);
 	if (mech == NULL) {
-		sasl_server_auth_client_error(client,
+		sasl_server_auth_failed(client,
 			"Unsupported authentication mechanism.");
 		return;
 	}
 
 	if (!client->secured && disable_plaintext_auth &&
 	    (mech->flags & MECH_SEC_PLAINTEXT) != 0) {
-		sasl_server_auth_client_error(client,
+		sasl_server_auth_failed(client,
 			"Plaintext authentication disabled.");
 		return;
 	}
