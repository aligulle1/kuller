Index: stream/realrtsp/real.c
===================================================================
--- stream/realrtsp/real.c	(revision 29446)
+++ stream/realrtsp/real.c	(working copy)
@@ -382,10 +382,14 @@
     ph.flags=0;
   *buffer = xbuffer_ensure_size(*buffer, 12+size);
   if(rdt_rawdata) {
+      if (size < 12)
+          return 0;
     n=rtsp_read_data(rtsp_session, *buffer, size-12);
     return (n <= 0) ? 0 : n;
   }
   rmff_dump_pheader(&ph, *buffer);
+  if (size < 12)
+      return 0;
   size-=12;
   n=rtsp_read_data(rtsp_session, (*buffer)+12, size);
 
