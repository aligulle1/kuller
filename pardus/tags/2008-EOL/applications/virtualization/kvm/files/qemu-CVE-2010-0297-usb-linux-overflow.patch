diff -Naurp kvm-84.orig/qemu/usb-linux.c kvm-84/qemu/usb-linux.c
--- kvm-84.orig/qemu/usb-linux.c	2010-02-05 09:05:56.000000000 +0200
+++ kvm-84/qemu/usb-linux.c	2010-02-05 09:06:22.000000000 +0200
@@ -119,7 +119,7 @@ struct ctrl_struct {
     uint16_t offset;
     uint8_t  state;
     struct   usb_ctrlrequest req;
-    uint8_t  buffer[1024];
+    uint8_t  buffer[8192];
 };
 
 typedef struct USBHostDevice {
@@ -556,6 +556,7 @@ static int usb_host_handle_control(USBHo
     struct usbdevfs_urb *urb;
     AsyncURB *aurb;
     int ret, value, index;
+    int buffer_len;
 
     /* 
      * Process certain standard device requests.
@@ -584,6 +585,13 @@ static int usb_host_handle_control(USBHo
 
     /* The rest are asynchronous */
 
+    buffer_len = 8 + s->ctrl.len;
+    if (buffer_len > sizeof(s->ctrl.buffer)) {
+	    fprintf(stderr, "husb: ctrl buffer too small (%u > %lu)\n",
+		    buffer_len, sizeof(s->ctrl.buffer));
+	    return USB_RET_STALL;
+    }
+
     aurb = async_alloc();
     aurb->hdev   = s;
     aurb->packet = p;
@@ -600,7 +608,7 @@ static int usb_host_handle_control(USBHo
     urb->endpoint = p->devep;
 
     urb->buffer        = &s->ctrl.req;
-    urb->buffer_length = 8 + s->ctrl.len;
+    urb->buffer_length = buffer_len;
 
     urb->usercontext = s;
 
