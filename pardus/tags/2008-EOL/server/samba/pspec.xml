<?xml version="1.0" ?>
<!DOCTYPE PISI SYSTEM "http://www.pardus.org.tr/projeler/pisi/pisi-spec.dtd">
<PISI>
    <Source>
        <Name>samba</Name>
        <Homepage>http://www.samba.org</Homepage>
        <Packager>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Packager>
        <License>GPLv2</License>
        <IsA>service</IsA>
        <Summary>A suite of SMB and CIFS client/server programs for UNIX</Summary>
        <Description>Samba is a free software implementation of Microsoft's networking protocol released under the GNU General Public License. As of version 3, Samba not only provides file and print services for various Microsoft Windows clients but can also integrate with a Windows Server domain, either as a Primary Domain Controller (PDC) or as a Domain Member. It can also be part of an Active Directory domain.</Description>
        <Archive sha1sum="52240aa9f2f5584f1978d788024fa2d6cb208e56" type="targz">http://us6.samba.org/samba/ftp/stable/samba-3.2.15.tar.gz</Archive>
        <BuildDependencies>
            <Dependency>popt</Dependency>
            <Dependency>acl</Dependency>
            <Dependency>cups</Dependency>
            <Dependency>pam</Dependency>
            <Dependency>python</Dependency>
            <Dependency>readline</Dependency>
            <Dependency>libxml2</Dependency>
            <Dependency>zlib</Dependency>
            <Dependency releaseFrom="9">openldap-client</Dependency>
            <Dependency releaseFrom="5">mit-kerberos</Dependency>
            <Dependency>libaio</Dependency>
            <Dependency>dmapi</Dependency>
            <Dependency>libcap</Dependency>
        </BuildDependencies>
        <Patches>
            <Patch level="1">3.0.26a-lazyldflags.patch</Patch>

            <!-- Suse patches -->
            <Patch>smb_child_crash.patch</Patch>
            <Patch>smbprint-debugfilepath.diff</Patch>

            <!-- Ubuntu/Debian patches -->
            <Patch level="1">documentation.patch</Patch>
            <Patch level="1">smbpasswd-syslog.patch</Patch>

            <!-- Add Pardus vendor suffix -->
            <Patch>add_vendor_suffix.patch</Patch>

            <!-- #FIXME: security comment -->
            <Patch level="1">0004-mount.cifs-properly-check-for-mount-being-in-fstab-w.patch</Patch>
            <Patch level="1">0005-mount.cifs-take-extra-care-that-mountpoint-isn-t-cha.patch</Patch>
            <Patch level="1">0006-mount.cifs-check-for-invalid-characters-in-device-na.patch</Patch>
            <!-- security: do not allow wide links to be used when unix extensions are loaded, 12228 -->
            <Patch level="1">samba-3.3.10-disable-widelinks.patch</Patch>
        </Patches>
    </Source>

    <Package>
        <Name>samba</Name>
        <RuntimeDependencies>
            <Dependency>acl</Dependency>
            <Dependency>cups</Dependency>
            <Dependency>libxml2</Dependency>
            <Dependency releaseFrom="9">openldap-client</Dependency>
            <Dependency>mit-kerberos</Dependency>
            <Dependency>libaio</Dependency>
            <Dependency>dmapi</Dependency>
            <Dependency>libcap</Dependency>
            <Dependency releaseFrom="17">comar-api</Dependency>
        </RuntimeDependencies>
        <Conflicts>
            <Package>samba-python</Package>
        </Conflicts>
        <Files>
            <Path fileType="config">/etc</Path>
            <Path fileType="header">/usr/include</Path>
            <Path fileType="library">/lib/security</Path>
            <Path fileType="library">/usr/lib</Path>
            <Path fileType="executable">/sbin</Path>
            <Path fileType="executable">/usr/bin</Path>
            <Path fileType="executable">/usr/sbin</Path>
            <Path fileType="data">/var/cache/samba</Path>
            <Path fileType="data">/var/lib</Path>
            <Path fileType="data">/var/log</Path>
            <Path fileType="data">/var/run</Path>
            <Path fileType="data">/var/spool/samba</Path>
            <Path fileType="man">/usr/share/man</Path>
        </Files>
        <AdditionalFiles>
            <AdditionalFile owner="root" permission="0644" target="/etc/samba/smbusers">smbusers</AdditionalFile>
            <AdditionalFile owner="root" permission="0644" target="/etc/samba/smb.conf">smb.conf</AdditionalFile>
            <AdditionalFile owner="root" permission="0644" target="/etc/samba/lmhosts">lmhosts</AdditionalFile>
            <AdditionalFile owner="root" permission="0644" target="/etc/samba/system-auth-winbind">system-auth-winbind</AdditionalFile>
            <AdditionalFile owner="root" permission="0644" target="/etc/pam.d/samba">samba.pam</AdditionalFile>
            <AdditionalFile owner="root" permission="0644" target="/etc/conf.d/samba">samba.confd</AdditionalFile>
        </AdditionalFiles>
        <Provides>
            <COMAR script="package.py">System.Package</COMAR>
            <COMAR script="service.py">System.Service</COMAR>
        </Provides>
    </Package>

    <History>
        <Update release="46" type="security">
            <Date>2010-02-06</Date>
            <Version>3.2.15</Version>
            <Comment>
                - Add upstream patch to disable wide links when unix extensions are used. Anyone who has a writable smb share can browse files outside that share by using symlinks when wide links and unix extensions are used together. #12228
            </Comment>
            <Name>Eren Türkay</Name>
            <Email>eren@pardus.org.tr</Email>
        </Update>
        <Update release="45" type="security">
            <Date>2010-01-28</Date>
            <Version>3.2.15</Version>
            <Comment>
                - mount.cifs: Add patch to restrict fstab corruption when special characters are used in directory names (a similar issue with CVE-2005-3531, #12143)
                - mount.cifs: Add patch to fix privilege escalation via symlink attack (CVE-2009-3297, #12143)
            </Comment>
            <Name>Eren Türkay</Name>
            <Email>eren@pardus.org.tr</Email>
        </Update>
        <Update release="44">
            <Date>2009-11-05</Date>
            <Version>3.2.15</Version>
            <Comment>Fix the startup of nmbd (#9336).</Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
        <Update release="43" type="security">
            <Date>2009-10-02</Date>
            <Version>3.2.15</Version>
            <Comment>
                - Version bump to fix CVE-2009-2813, CVE-2009-2948, CVE-2009-2906 (#11250),
                - Fixed startup of winbind daemon.
            </Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
        <Update release="42" type="security">
            <Date>2009-06-25</Date>
            <Version>3.2.13</Version>
            <Comment>Version bump to fix format string vulnerability (CVE-2009-1886,CVE-2009-1888) in smbclient (#10128).</Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
        <Update release="41">
            <Date>2009-06-19</Date>
            <Version>3.2.12</Version>
            <Comment>Version bump and install /var/spool/samba correctly (#10061).</Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
        <Update release="40">
            <Date>2009-04-20</Date>
            <Version>3.2.11</Version>
            <Comment>
                - Version bump to the last bugfix release for 3.2.x series:
                    Fix domain logins for WinXP clients pre SP3,
                    Fix samr_OpenDomain access checks,
                    Fix smbd crash for close_on_completion,
                    Fixes a panic issue while migrating passdb.tdb from older Samba versions,
                    Fix guest authentication in setups with "security = share" and
                    "guest ok = yes" when Winbind is running.
            </Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
        <Update release="39">
            <Date>2009-02-09</Date>
            <Version>3.2.8</Version>
            <Comment>
                - Version bump to 3.2.8 containing numerous important bugfixes for:
                    Excel save operation corrupts file ACLs,
                    smbclient du command does not recuse properly,
                    Fix smbclient crashes,
                    Allow mounts to ipv6 capable servers in mount.cifs,
                    mget shouldn't segfault without arguments.
                    - Fixed service script not reloading service.
            </Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
        <Update release="38" type="security">
            <Date>2009-01-06</Date>
            <Version>3.2.7</Version>
            <Comment>Version bump to fix CVE-2009-0022 (http://us6.samba.org/samba/security/CVE-2009-0022.html)</Comment>
            <Name>Gökçen Eraslan</Name>
            <Email>gokcen@pardus.org.tr</Email>
        </Update>
        <Update release="37" type="security">
            <Date>2008-12-24</Date>
            <Version>3.2.6</Version>
            <Comment>
                - Version bump to 3.2.6:
                - Fixes CVE-2008-4314,
                - Fixes the problem of disabled controls in TASMA module (#8716, #8882).
            </Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
       <Update release="36">
            <Date>2008-10-24</Date>
            <Version>3.2.4</Version>
            <Comment>
                - Version bump to the latest stable release,
                - Added missing pam_winbind.so to /lib/security (Fixes #7119),
                - Removed deprecated smbmount (Fixes #6845),
                - Removed patches that are already in upstream,
                - A lot of patches are adapted to the new 3.2.x branch.
            </Comment>
            <Name>Ozan Çağlayan</Name>
            <Email>ozan@pardus.org.tr</Email>
        </Update>
        <Update release="35">
            <Date>2008-07-28</Date>
            <Version>3.0.31</Version>
            <Comment>Version bump to bugfix release</Comment>
            <Name>Gökçen Eraslan</Name>
            <Email>gokcen@pardus.org.tr</Email>
        </Update>
        <Update release="34" type="security">
            <Date>2008-06-05</Date>
            <Version>3.0.30</Version>
            <Comment>Version bump to bugfix release, CVE-2008-1105 is also merged</Comment>
            <Name>Gökçen Eraslan</Name>
            <Email>gokcen@pardus.org.tr</Email>
        </Update>
        <Update release="33" type="security">
            <Date>2008-05-28</Date>
            <Version>3.0.28a</Version>
            <Comment>Add patch to fix CVE-2008-1105</Comment>
            <Name>Eren Türkay</Name>
            <Email>turkay.eren@gmail.com</Email>
        </Update>
        <Update release="32">
            <Date>2008-03-23</Date>
            <Version>3.0.28a</Version>
            <Comment>Version bump to bugfix release</Comment>
            <Name>Gökçen Eraslan</Name>
            <Email>gokcen@pardus.org.tr</Email>
        </Update>
        <Update release="31" type="security">
            <Date>2007-12-10</Date>
            <Version>3.0.28</Version>
            <Comment>Stable update to fix CVE-2007-6015</Comment>
            <Name>İsmail Dönmez</Name>
            <Email>ismail@pardus.org.tr</Email>
        </Update>
        <Update release="30" type="security">
            <Date>2007-12-04</Date>
            <Version>3.0.27a</Version>
            <Comment>Stable update to fix the regression fix for CVE-2007-4572</Comment>
            <Name>İsmail Dönmez</Name>
            <Email>ismail@pardus.org.tr</Email>
        </Update>
        <Update release="29" type="security">
            <Date>2007-11-17</Date>
            <Version>3.0.27</Version>
            <Comment>Fix a regression introduced by the fix for CVE-2007-4572</Comment>
            <Name>İsmail Dönmez</Name>
            <Email>ismail@pardus.org.tr</Email>
        </Update>
        <Update release="28" type="security">
            <Date>2007-11-15</Date>
            <Version>3.0.27</Version>
            <Comment>Stable update to fix CVE-2007-4572 and CVE-2007-5398</Comment>
            <Name>İsmail Dönmez</Name>
            <Email>ismail@pardus.org.tr</Email>
        </Update>
        <Update release="27">
            <Date>2007-11-05</Date>
            <Version>3.0.26a</Version>
            <Comment>Stable update and enable DNS updates</Comment>
            <Name>İsmail Dönmez</Name>
            <Email>ismail@pardus.org.tr</Email>
        </Update>
        <Update release="26">
            <Date>2007-09-12</Date>
            <Version>3.0.26</Version>
            <Comment>Stable update</Comment>
            <Name>Alper Somuncu</Name>
            <Email>alpersomuncu@gmail.com</Email>
        </Update>
        <Update release="25" type="security">
            <Date>2007-09-11</Date>
            <Version>3.0.25c</Version>
            <Comment>Fix CVE-2007-4138</Comment>
            <Name>İsmail Dönmez</Name>
            <Email>ismail@pardus.org.tr</Email>
        </Update>
        <Update release="24">
            <Date>2007-08-21</Date>
            <Version>3.0.25c</Version>
            <Comment>Stable update</Comment>
            <Name>İsmail Dönmez</Name>
            <Email>ismail@pardus.org.tr</Email>
        </Update>
        <Update release="23">
            <Date>2007-06-27</Date>
            <Version>3.0.25b</Version>
            <Comment>Stable update</Comment>
            <Name>İsmail Dönmez</Name>
            <Email>ismail@pardus.org.tr</Email>
        </Update>
        <Update release="22">
            <Date>2007-05-27</Date>
            <Version>3.0.25a</Version>
            <Comment>Service script updated.</Comment>
            <Name>Bahadır Kandemir</Name>
            <Email>bahadir@pardus.org.tr</Email>
        </Update>
        <Update release="21">
            <Date>2007-05-26</Date>
            <Version>3.0.25a</Version>
            <Comment>Important bugfix release</Comment>
            <Name>İsmail Dönmez</Name>
            <Email>ismail@pardus.org.tr</Email>
        </Update>
        <Update release="20" type="security">
            <Date>2007-05-14</Date>
            <Version>3.0.25</Version>
            <Comment>Stable update to fix CVE-2007-2444, CVE-2007-2446 and CVE-2007-2447</Comment>
            <Name>İsmail Dönmez</Name>
            <Email>ismail@pardus.org.tr</Email>
        </Update>
        <Update release="19">
            <Date>2007-03-30</Date>
            <Version>3.0.24</Version>
            <Comment>Add missing depecies (cyrus-sasl, libcap)</Comment>
            <Name>Ekin Meroğlu</Name>
            <Email>ekin@pardus.org.tr</Email>
        </Update>
        <Update release="18">
            <Date>2007-02-10</Date>
            <Version>3.0.24</Version>
            <Comment>Add dmapi dependency for XFS ACL support</Comment>
            <Name>İsmail Dönmez</Name>
            <Email>ismail@pardus.org.tr</Email>
        </Update>
        <Update release="17">
            <Date>2007-02-05</Date>
            <Version>3.0.24</Version>
            <Comment>Add missing libaio dep</Comment>
            <Name>İsmail Dönmez</Name>
            <Email>ismail@pardus.org.tr</Email>
        </Update>
        <Update release="16" type="security">
            <Date>2007-02-05</Date>
            <Version>3.0.24</Version>
            <Comment>Stable update to fix CVE-2007-045{2,3,4}</Comment>
            <Name>İsmail Dönmez</Name>
            <Email>ismail@pardus.org.tr</Email>
        </Update>
        <Update release="15">
            <Date>2007-01-15</Date>
            <Version>3.0.23_p4</Version>
            <Comment>Stable update</Comment>
            <Name>İsmail Dönmez</Name>
            <Email>ismail@pardus.org.tr</Email>
        </Update>
        <Update release="14">
            <Date>2006-11-28</Date>
            <Version>3.0.23_p3</Version>
            <Comment>Use pythonmodules</Comment>
            <Name>S.Çağlar Onur</Name>
            <Email>caglar@pardus.org.tr</Email>
        </Update>
        <Update release="13">
            <Date>2006-10-15</Date>
            <Version>3.0.23_p3</Version>
            <Comment>Install mount.cifs helpers in /usr/bin</Comment>
            <Name>Ekin Meroğlu</Name>
            <Email>ekin@pardus.org.tr</Email>
        </Update>
        <Update release="12">
            <Date>2006-10-09</Date>
            <Version>3.0.23_p3</Version>
            <Comment>Service script updated.</Comment>
            <Name>Bahadır Kandemir</Name>
            <Email>bahadir@pardus.org.tr</Email>
        </Update>
        <Update release="11">
            <Date>2006-09-09</Date>
            <Version>3.0.23_p3</Version>
            <Comment>Version bump</Comment>
            <Name>İsmail Dönmez</Name>
            <Email>ismail@pardus.org.tr</Email>
        </Update>
        <Update release="10">
            <Date>2006-07-11</Date>
            <Version>3.0.23</Version>
            <Comment>LDAP support</Comment>
            <Name>Ali Erdinç Köroğlu</Name>
            <Email>erdinc@pardus.org.tr</Email>
        </Update>
        <Update release="9" type="security">
            <Date>2006-07-11</Date>
            <Version>3.0.23</Version>
            <Comment>Version bump to fix CAN-2006-3403</Comment>
            <Name>İsmail Dönmez</Name>
            <Email>ismail@pardus.org.tr</Email>
        </Update>
        <Update release="8">
            <Date>2006-05-07</Date>
            <Version>3.0.22</Version>
            <Comment>Added müdür script</Comment>
            <Name>Onur Küçük</Name>
            <Email>onur@pardus.org.tr</Email>
        </Update>
        <Update release="7" type="security">
            <Date>2006-03-30</Date>
            <Version>3.0.22</Version>
            <Comment>Version bump to fix CAN-2006-1059</Comment>
            <Name>İsmail Dönmez</Name>
            <Email>ismail@pardus.org.tr</Email>
        </Update>
        <Update release="6">
            <Date>2006-03-02</Date>
            <Version>3.0.21c</Version>
            <Comment>Stable update</Comment>
            <Name>İsmail Dönmez</Name>
            <Email>ismail@pardus.org.tr</Email>
        </Update>
        <Update release="5">
            <Date>2006-02-04</Date>
            <Version>3.0.21b</Version>
            <Comment>fix #1712</Comment>
            <Name>S.Çağlar Onur</Name>
            <Email>caglar@pardus.org.tr</Email>
        </Update>
        <Update release="4">
            <Date>2006-02-02</Date>
            <Version>3.0.21b</Version>
            <Comment>New stable release, and enable Kerberos support</Comment>
            <Name>İsmail Dönmez</Name>
            <Email>ismail@pardus.org.tr</Email>
        </Update>
        <Update release="3">
            <Date>2006-01-25</Date>
            <Version>3.0.20b</Version>
            <Comment>Fix printing with remote SMB systems, bugfix from Muazzez Mirasedoğlu</Comment>
            <Name>Onur Küçük</Name>
            <Email>onur@pardus.org.tr</Email>
        </Update>
        <Update release="2">
            <Date>2005-12-15</Date>
            <Version>3.0.20b</Version>
            <Comment>Default smb.conf powered by Doruk Fişek (#1166)</Comment>
            <Name>S.Çağlar Onur</Name>
            <Email>caglar@pardus.org.tr</Email>
        </Update>
        <Update release="1">
            <Date>2005-11-28</Date>
            <Version>3.0.20b</Version>
            <Comment>First release.</Comment>
            <Name>S.Çağlar Onur</Name>
            <Email>caglar@pardus.org.tr</Email>
        </Update>
    </History>
</PISI>
