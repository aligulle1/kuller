diff -Nur clamav-0.93.3/libclamav/chmunpack.c clamav-0.93.3-new/libclamav/chmunpack.c
--- clamav-0.93.3/libclamav/chmunpack.c	2008-04-07 12:18:42.000000000 +0300
+++ clamav-0.93.3-new/libclamav/chmunpack.c	2008-09-05 10:55:18.000000000 +0300
@@ -449,7 +449,7 @@
 	cli_dbgmsg("in read_chunk\n");
 
 	if (metadata->itsp_hdr.block_len < 8 || metadata->itsp_hdr.block_len > 33554432) {
-		return FALSE;
+		return CL_EFORMAT;
 	}
 
 	if (metadata->m_area != NULL) {
@@ -911,7 +911,9 @@
 			cli_dbgmsg("read_chunk failed");
 			goto abort;
 		}
-		read_control_entries(metadata);
+		if (read_control_entries(metadata) == FALSE) {
+		    goto abort;
+        }
 		metadata->num_chunks--;
 		metadata->chunk_offset += metadata->itsp_hdr.block_len;
 	}
