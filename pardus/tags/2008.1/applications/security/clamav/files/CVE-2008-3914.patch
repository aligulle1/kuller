diff -Nur clamav-0.93.3/libclamav/others.c clamav-0.93.3-new/libclamav/others.c
--- clamav-0.93.3/libclamav/others.c	2008-07-07 14:06:30.000000000 +0300
+++ clamav-0.93.3-new/libclamav/others.c	2008-09-05 12:10:54.000000000 +0300
@@ -799,7 +799,11 @@
 	return -1;
     }
 
-    if(!(buffer = cli_malloc(FILEBUFF)))
+    if(!(buffer = cli_malloc(FILEBUFF))){
+        close(s);
+        close(d);
+    }
+
 	return -1;
 
     while((bytes = cli_readn(s, buffer, FILEBUFF)) > 0)
diff -Nur clamav-0.93.3/libclamav/sis.c clamav-0.93.3-new/libclamav/sis.c
--- clamav-0.93.3/libclamav/sis.c	2008-04-02 23:17:27.000000000 +0300
+++ clamav-0.93.3-new/libclamav/sis.c	2008-09-05 12:08:16.000000000 +0300
@@ -506,6 +506,7 @@
 	    return CL_EIO;
 	  }
 	  if (cli_writen(fd, decomp, olen)!=(int)olen) {
+	    close(fd);
 	    free(decomp);
 	    free(ptrs);
 	    free(alangs);
diff -Nur clamav-0.93.3/shared/tar.c clamav-0.93.3-new/shared/tar.c
--- clamav-0.93.3/shared/tar.c	2008-05-27 14:45:19.000000000 +0300
+++ clamav-0.93.3-new/shared/tar.c	2008-09-05 12:12:14.000000000 +0300
@@ -60,10 +60,8 @@
 	unsigned int i, chksum = 0;
 
 
-    if((s = open(file, O_RDONLY|O_BINARY)) == -1) {
-	close(s);
+    if((s = open(file, O_RDONLY|O_BINARY)) == -1)
 	return -1;
-    }
 
     if(fstat(s, &sb) == -1) {
 	close(s);
