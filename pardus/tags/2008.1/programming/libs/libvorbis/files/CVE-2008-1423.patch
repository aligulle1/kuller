--- lib/codebook.c.orig	2008-05-14 13:36:45.000000000 +0300
+++ lib/codebook.c	2008-05-14 13:40:42.000000000 +0300
@@ -159,6 +159,8 @@
   s->entries=oggpack_read(opb,24);
   if(s->entries==-1)goto _eofout;
 
+  if(_ilog(s->dim)+_ilog(s->entries)>24)goto _eofout;
+
   /* codeword ordering.... length ordered or unordered? */
   switch((int)oggpack_read(opb,1)){
   case 0:
