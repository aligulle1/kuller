--- lib/codebook.c.orig	2008-05-14 13:36:45.000000000 +0300
+++ lib/codebook.c	2008-05-14 13:38:16.000000000 +0300
@@ -225,7 +225,7 @@
       int quantvals=0;
       switch(s->maptype){
       case 1:
-	quantvals=_book_maptype1_quantvals(s);
+	quantvals=(s->dim==0?0:_book_maptype1_quantvals(s));
 	break;
       case 2:
 	quantvals=s->entries*s->dim;
