--- cups/auth.c
+++ cups/auth.c
@@ -166,6 +166,16 @@ cupsDoAuthentication(http_t     *http,	/
   else if (http->status == HTTP_UNAUTHORIZED)
     http->digest_tries ++;
 
+  if (http->status == HTTP_UNAUTHORIZED && http->digest_tries >= 3)
+  {
+      DEBUG_printf(("cupsDoAuthentication: too many Negotiate tries (%d)\n",
+                  http->digest_tries));
+
+      return (-1);
+  }
+
+
+
  /*
   * Got a password; encode it for the server...
   */
@@ -205,14 +215,6 @@ cupsDoAuthentication(http_t     *http,	/
     }
 #  endif /* __APPLE__ */
 
-    if (http->status == HTTP_UNAUTHORIZED && http->digest_tries >= 3)
-    {
-      DEBUG_printf(("cupsDoAuthentication: too many Negotiate tries (%d)\n",
-                    http->digest_tries));
-  
-      return (-1);
-    }
-
     if (http->gssname == GSS_C_NO_NAME)
     {
       if ((gss_service_name = getenv("CUPS_GSSSERVICENAME")) == NULL)
